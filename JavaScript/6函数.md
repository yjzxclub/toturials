本文按照 Mozilla 贡献者基于 CC-BY-SA 2.5 协议发布的以下文章改编:

- <https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Building_blocks/Functions>
- <https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Building_blocks/Build_your_own_function>
- <https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Functions>

本文基于 CC-BY-SA 4.0 协议发布。

# 函数

在 JS 中另一个基本概念是函数, 它允许你在一个代码块中存储一段用于处理单任务的代码，然后在任何你需要的时候用一个简短的命令来调用，而不是把相同的代码写很多次。在本文中，我们将探索函数的基本概念，如基本语法、如何定义和调用、范围和参数。

## 函数的引入

现有有一个大于等于 2 的正整数 a ，现在我们需要判断这个数字是不是质数。质数是只有 1 和它自己两个因数的数。对于所有的大于 2 的数，我们需要枚举那些大于 2 小于等于根号 a 的所有数字，一一确定它们是不是 a 的因数，如果都找不到那么它肯定是质数。

``` js
let a = 114514; // 很明显这是个合数
let isPrime = false; // 一个 boolen ，记录是否为质数

if (a === 2) {
    isPrime = true;
} else {
    isPrime = true; // 先暂时赋值，如果后面没被覆盖肯定是质数
    for (let i = 2; i <= Math.sqrt(a); i++) {
        if (a % i === 0) {
            isPrime = false;
        }
    }
}

if (isPrime) {
    console.log("是质数。");
} else {
    console.log("不是质数。");
}
```

看起来很合理，但是如果有三个数，分别是 a, b, c。或者有三十个数，你是不是要把上面那个 if else 和循环都复制一下？这么做的话太麻烦了。所以我们有更好的方法：**函数 (function)** 。这就是上面写成函数的例子：

``` js
function judgePrime(a) {
    let isPrime = false;
    if (a === 2) {
        isPrime = true;
    } else {
        isPrime = true; // 先暂时赋值，如果后面没被覆盖肯定是质数
        for (let i = 2; i <= Math.sqrt(a); i++) {
            if (a % i === 0) {
                isPrime = false;
            }
        }
    }
    return isPrime;
}

let a = 114514, b = 17;

if (judgePrime(a)) {
    console.log(a + " 是质数。");
} else {
    console.log(a + " 不是质数。");
}

if (judgePrime(b)) {
    console.log(b + " 是质数。");
} else {
    console.log(b + " 不是质数。");
}
```

我们可以看出函数的结构：

``` js
function 函数名(参数) {
    // 主体代码块
    return;
}
```

一个函数定义（也称为函数声明，或函数语句）由一系列的 function 关键字组成，依次为：

- function 关键字。
- 函数的名称。
- 函数**参数列表**，包围在括号中并由逗号分隔。
- 定义函数的 JavaScript 语句，用大括号{}括起来。

比如我们从定义一个简单的乘方运算函数开始，这个函数可以得到给定数字的平方：

``` js
function square(number) {
  return number * number;
}
```

函数 square 使用了一个参数，叫作 number 。这个函数只有一个语句，它说明该函数将函数的参数 number 自乘（就是平方）后返回。函数的 return 语句确定了函数的返回值。返回值就像普通的数值一样。比如下面这个代码：

``` js
function square(number) {
  return number * number;
}
let x = square(3);
```

它执行了这样的操作：

- 声明一个 square 函数。
- 调用函数, 将 3 作为参数传给函数，此时函数的 number 变量的值变成了 3 。
- 程序继续向下运行，计算 number * number 的值。
- 将计算出来的值返回回来。
- 然后 `let x = square(3)` 就相当于 `let x = 9`，x 就变成了 9 了。

可以非常清楚的非常清楚地看到，调用函数的方式是在函数名后加上一对括号，括号中包含参数。如果有多个参数就可以用逗号分隔：

``` js
function add(a, b) {
    return a + b;
}
let x = add(1, 3); // x = 1 + 3
```

有些函数可以没有返回值，比如我有一个输出的函数：

``` js
function print(x) {
    console.log("你的参数是 " + x);
}
print(12);
print('aaa');
```

这种情况下面，函数将会返回默认值 `undefined`。

## 函数和对象

我们之前谈过了对象，现在是进一步扩充它的时候了。

### 函数作为值

函数可以被作为一个值赋值给一个变量：

``` js
function add(a, b) {
    return a + b;
}
let myadd = add;
let x = myadd(1, 3);
```

更加常用的是这么写：

``` js
let myadd = function (a, b) {
    return a + b;
}
```

这种情况下面会创造一个**匿名函数**，并且将这个函数赋值给 myadd 变量，使它的值成为一个函数，并且可以使用函数的方式调用。

### 方法

那么，既然函数可以赋值给普通变量，那么也可以赋值给一个对象成员了。一个函数成员叫做**方法**。，比如我们举个例子：

``` js
let cat = {
    name: "Ket",
    say: function() {
        console.log("My name is " + this.name);
    }
}
cat.say();
```

你也许在我们的方法里注意到了一些奇怪的地方， `this` 到底是什么？
